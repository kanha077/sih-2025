<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Corner AI | Ananda Mental Health</title>
    <script>
        (function() {
            const theme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (theme === 'dark' || (!theme && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        :root {--primary: 220 70% 50%;--primary-foreground: 0 0% 98%;--secondary: 280 60% 50%;--secondary-foreground: 0 0% 98%;--accent: 340 75% 55%;--accent-foreground: 0 0% 98%;--background: 0 0% 100%;--foreground: 224 71.4% 4.1%;--muted: 220 14.3% 95.9%;--muted-foreground: 220 8.9% 46.1%;--border: 220 13% 91%;--ring: 220 70% 50%;--card: 0 0% 100%;--card-foreground: 224 71.4% 4.1%;--input: 220 14.3% 95.9%;--destructive: 0 84% 60%;--destructive-foreground: 0 0% 98%;--popover: 0 0% 100%;--popover-foreground: 224 71.4% 4.1%;--gradient-primary: linear-gradient(135deg, hsl(var(--primary)), hsl(280 65% 60%));--shadow-elegant: 0 10px 30px -10px hsl(var(--primary) / 0.3);--shadow-primary: 0 0 40px hsl(var(--primary) / 0.4);--shadow-glass: 0 8px 32px rgba(31, 38, 135, 0.37);--transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);--transition-spring: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);--radius: 0.75rem;--radius-lg: 1rem;--radius-xl: 1.5rem;--radius-full: 9999px;}
        .dark {--primary: 220 70% 55%;--secondary: 280 60% 55%;--accent: 340 75% 60%;--background: 224 71.4% 4.1%;--foreground: 0 0% 98%;--muted: 220 13% 18%;--muted-foreground: 220 8.9% 64.9%;--border: 220 13% 24%;--card: 224 71.4% 6%;--card-foreground: 0 0% 98%;--input: 220 13% 18%;--popover: 224 71.4% 6%;--popover-foreground: 0 0% 98%;--shadow-elegant: 0 10px 30px -10px hsl(var(--primary) / 0.2);}
        * {box-sizing: border-box;margin: 0;padding: 0;} html {scroll-behavior: smooth;}
        body {font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;background: hsl(var(--background));color: hsl(var(--foreground));line-height: 1.6;transition: var(--transition-smooth);min-height: 100vh;position: relative;overflow-x: hidden; display: flex; flex-direction: column;}
        body::before {content: '';position: fixed;top: 0;left: 0;width: 100%;height: 100%;background: radial-gradient(circle at 20% 80%, hsl(var(--primary) / 0.08) 0%, transparent 50%), radial-gradient(circle at 80% 20%, hsl(var(--secondary) / 0.08) 0%, transparent 50%);pointer-events: none;z-index: -1;animation: backgroundFlow 30s ease-in-out infinite;}
        @keyframes backgroundFlow {0%, 100% {transform: translate(0, 0) scale(1);filter: hue-rotate(0deg);} 50% {transform: translate(30px, -30px) scale(1.05);filter: hue-rotate(180deg);}}
        .navbar {background: rgba(255, 255, 255, 0.1);backdrop-filter: blur(20px) saturate(180%);border-bottom: 1px solid hsl(var(--border) / 0.5);padding: 1.25rem 2rem;display: flex;justify-content: space-between;align-items: center;position: sticky;top: 0;z-index: 1000;box-shadow: var(--shadow-glass); flex-shrink: 0;}
        .dark .navbar {background: rgba(0, 0, 0, 0.2);border-bottom: 1px solid hsl(var(--border) / 0.3);}
        .navbar h1 {font-size: 1.875rem;font-weight: 800;background: var(--gradient-primary);-webkit-background-clip: text;-webkit-text-fill-color: transparent;background-clip: text;text-shadow: 0 0 30px hsl(var(--primary) / 0.5);}
        #back-to-forum-btn {background: var(--gradient-primary);color: hsl(var(--primary-foreground));border: none;padding: 0.875rem 1.75rem;border-radius: var(--radius-full);cursor: pointer;font-weight: 600;font-size: 0.875rem;transition: var(--transition-spring);box-shadow: var(--shadow-primary);text-decoration: none;display: inline-flex;align-items: center;gap: 0.5rem;}
        #back-to-forum-btn:hover {transform: translateY(-3px) scale(1.05);}
        .chat-container {width: 100%; max-width: 800px; margin: 2rem auto; display: flex; flex-direction: column; flex-grow: 1; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px) saturate(180%); border-radius: var(--radius-xl); border: 1px solid hsl(var(--border) / 0.5); box-shadow: var(--shadow-glass); animation: slideInUp 0.8s ease-out; overflow: hidden;}
        .dark .chat-container {background: rgba(0, 0, 0, 0.2);}
        @keyframes slideInUp {from {opacity: 0;transform: translateY(50px);} to {opacity: 1;transform: translateY(0);}}
        .chat-messages {display: flex; flex-direction: column; gap: 1.5rem; padding: 1.5rem; overflow-y: auto; flex-grow: 1;}
        .message {display: flex;gap: 1rem;align-items: flex-end;max-width: 85%;}
        .bot-message {align-self: flex-start;}
        .user-message {align-self: flex-end; flex-direction: row-reverse;}
        .avatar {width: 40px;height: 40px;border-radius: 50%;background: var(--gradient-primary);display: flex;align-items: center;justify-content: center;color: white;font-weight: 700;font-size: 1.25rem;box-shadow: var(--shadow-primary);flex-shrink: 0;border: 2px solid hsl(var(--card));}
        .user-message .avatar {background: var(--gradient-secondary);}
        .message-content {background: hsl(var(--card) / 0.8);backdrop-filter: blur(10px);padding: 1rem 1.25rem;border-radius: var(--radius-lg);border: 1px solid hsl(var(--border) / 0.7);box-shadow: var(--shadow-elegant);}
        .user-message .message-content {background: hsl(var(--primary)/0.1);}
        .message-content p {margin: 0;line-height: 1.7; white-space: pre-wrap; word-wrap: break-word;}
        .chat-input-form {display: flex; gap: 1rem; padding: 1.5rem; border-top: 1px solid hsl(var(--border) / 0.5); background: hsl(var(--background) / 0.5); backdrop-filter: blur(10px);}
        .chat-input {flex-grow: 1; border: 2px solid hsl(var(--border) / 0.5); border-radius: var(--radius-full); padding: 0.75rem 1.5rem; font-family: 'Inter', sans-serif; font-size: 1rem; background: hsl(var(--card) / 0.8); color: hsl(var(--foreground)); transition: var(--transition-smooth); resize: none;}
        .chat-input:focus {outline: none; border-color: hsl(var(--primary)); box-shadow: 0 0 0 4px hsl(var(--primary) / 0.1);}
        .send-btn {width: 48px; height: 48px; border: none; border-radius: 50%; background: var(--gradient-primary); color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: var(--transition-spring); box-shadow: var(--shadow-primary);}
        .send-btn:hover {transform: scale(1.1) rotate(10deg); box-shadow: 0 10px 20px hsl(var(--primary) / 0.4);}
        .send-btn:disabled {cursor: not-allowed; background: hsl(var(--muted));}
        .typing-indicator {align-self: flex-start; display: flex; align-items: center; gap: 0.5rem; margin-left: 56px; /* Align with bot message */}
        .typing-indicator span {width: 8px; height: 8px; background-color: hsl(var(--muted-foreground)); border-radius: 50%; animation: typing 1.4s infinite both;}
        .typing-indicator span:nth-child(2) {animation-delay: 0.2s;} .typing-indicator span:nth-child(3) {animation-delay: 0.4s;}
        @keyframes typing {0% {opacity: 0.2;} 20% {opacity: 1;} 100% {opacity: 0.2;}}
        @media (max-width: 768px) {.navbar {padding: 1rem;} .navbar h1 {font-size: 1.5rem;} #back-to-forum-btn {padding: 0.75rem 1.25rem; font-size: 0.8rem;} .chat-container {margin: 1rem; height: auto;} .chat-input-form {padding: 1rem;}}
    </style>
</head>
<body>
    <nav class="navbar"><h1>ðŸ’¼ Career Corner AI</h1><a href="forum.html" id="back-to-forum-btn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5M12 19l-7-7 7-7"/></svg> Back to Forum</a></nav>
    <main class="chat-container">
        <div class="chat-messages" id="chat-messages">
            <!-- Initial Bot Message -->
            <div class="message bot-message">
                <div class="avatar">ðŸ¤–</div>
                <div class="message-content">
                    <p>Hello! I'm Ananda AI, your personal career coach. I can help with resumes, interview preparation, networking strategies, and more. What's on your mind today?</p>
                </div>
            </div>
        </div>
        <form class="chat-input-form" id="chat-form">
            <input type="text" id="chat-input" class="chat-input" placeholder="Ask about resumes, interviews..." autocomplete="off">
            <button type="submit" class="send-btn" id="send-btn" title="Send message">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
            </button>
        </form>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            const sendBtn = document.getElementById('send-btn');
            const chatMessages = document.getElementById('chat-messages');

            const API_KEY = ""; // Keep this empty, it will be handled by the environment.
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;
            
            // The AI's persona and instructions
            const systemPrompt = `You are 'Ananda AI,' a friendly, encouraging, and knowledgeable career coach for university students. Your goal is to provide clear, actionable, and supportive advice. Keep your answers concise, well-structured (using Markdown for lists or bold text if helpful), and positive in tone. You are speaking to students who may be anxious or unsure about their careers, so be empathetic and start your responses in a warm, welcoming way.`;

            chatForm.addEventListener('submit', handleFormSubmit);

            async function handleFormSubmit(e) {
                e.preventDefault();
                const userQuery = chatInput.value.trim();
                if (!userQuery) return;

                addMessageToChat(userQuery, 'user');
                chatInput.value = '';
                setLoadingState(true);

                try {
                    const aiResponse = await getAIResponse(userQuery);
                    addMessageToChat(aiResponse, 'bot');
                } catch (error) {
                    console.error('Error fetching AI response:', error);
                    addMessageToChat('Sorry, I seem to be having trouble connecting right now. Please try again in a moment.', 'bot');
                } finally {
                    setLoadingState(false);
                }
            }
            
            function addMessageToChat(text, sender) {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${sender}-message`;

                const avatar = document.createElement('div');
                avatar.className = 'avatar';
                avatar.textContent = sender === 'bot' ? 'ðŸ¤–' : 'ðŸ‘¤';
                
                const messageContent = document.createElement('div');
                messageContent.className = 'message-content';
                
                // Simple markdown conversion for bold and lists
                let formattedText = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                formattedText = formattedText.replace(/^\* (.*$)/gm, '<ul><li>$1</li></ul>').replace(/<\/ul>(\s*?)<ul>/g, '');


                messageContent.innerHTML = `<p>${formattedText}</p>`;
                
                messageElement.appendChild(avatar);
                messageElement.appendChild(messageContent);
                chatMessages.appendChild(messageElement);
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            function showTypingIndicator() {
                const indicator = document.createElement('div');
                indicator.className = 'message bot-message typing-indicator';
                indicator.id = 'typing-indicator';
                indicator.innerHTML = '<span></span><span></span><span></span>';
                chatMessages.appendChild(indicator);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            function hideTypingIndicator() {
                const indicator = document.getElementById('typing-indicator');
                if (indicator) {
                    indicator.remove();
                }
            }
            
            function setLoadingState(isLoading) {
                chatInput.disabled = isLoading;
                sendBtn.disabled = isLoading;
                if (isLoading) {
                    showTypingIndicator();
                } else {
                    hideTypingIndicator();
                }
            }

            async function getAIResponse(userQuery) {
                const payload = {
                    contents: [{
                        parts: [{ text: userQuery }]
                    }],
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                };

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                     return "I'm not sure how to respond to that. Could you please rephrase your question?";
                }
            }
        });
    </script>
</body>
</html>
