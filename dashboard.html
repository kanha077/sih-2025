<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <style>
    .popup { display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.5);
      justify-content: center; align-items: center; }
    .popup-content { background: white; padding: 20px; border-radius: 8px; }
  </style>
</head>
<body>
  <h2 id="welcome">Welcome</h2>
  <p>This is your dashboard.</p>

  <div class="popup" id="test-popup">
    <div class="popup-content">
      <h3>Ready to take your test?</h3>
      <button id="yesBtn">Yes, start test</button>
      <button id="noBtn">No, later</button>
    </div>
  </div>

<script type="module">
  import { supabase } from "./js/supabaseClient.js";

  async function loadDashboard() {
    const { data: { user } } = await supabase.auth.getUser();

    if (!user) {
      alert("Not logged in!");
      window.location.href = "/index.html";
      return;
    }

    document.getElementById("welcome").innerText = `Welcome, ${user.email}`;

    setTimeout(() => {
      document.getElementById("test-popup").style.display = "flex";
    }, 1000);
  }

  document.getElementById("yesBtn").onclick = () => {
    window.location.href = "/test.html";
  };

  document.getElementById("noBtn").onclick = () => {
    document.getElementById("test-popup").style.display = "none";
  };

  loadDashboard();
</script>
</body>
</html>
