<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Student Forum | Anonymous Discussions</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
  <style>
    :root {
      --background-color: #1a1a2e; 
      --card-background: #16213e; 
      --accent-color: #0f3460;
      --primary-action: #e9ced2; 
      --primary-action-hover: #da99a3; 
      --text-primary: #e0fbfc;
      --text-secondary: #93b5c6; 
      --border-color: #2c3e50;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Inter',sans-serif; background:var(--background-color); color:var(--text-primary); }

    /* Navbar */
    .navbar { background:var(--card-background); padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid var(--border-color); position:sticky; top:0; z-index:100; }
    .navbar h1 { font-size:1.5rem; }
    #logout-btn { background:var(--primary-action); border:none; padding:0.5rem 1rem; border-radius:5px; font-weight:500; color:#fff; cursor:pointer; }

    /* Layout */
    .main-layout { display:grid; grid-template-columns:250px 1fr; gap:2rem; max-width:1200px; margin:2rem auto; padding:0 1rem; }
    .sidebar { background:var(--card-background); padding:1.5rem; border-radius:8px; height:fit-content; }
    .sidebar h3 { margin-bottom:0.5rem; border-bottom:1px solid var(--border-color); padding-bottom:0.5rem; }
    .sort-options button { display:block; width:100%; border:none; background:none; color:var(--text-secondary); text-align:left; padding:0.75rem; border-radius:5px; cursor:pointer; transition:0.2s; }
    .sort-options button.active, .sort-options button:hover { background:var(--accent-color); color:var(--text-primary); }

    /* Post creator */
    .post-creator { background:var(--card-background); padding:1.5rem; border-radius:8px; margin-bottom:1.5rem; }
    .post-creator textarea { width:100%; min-height:80px; background:var(--accent-color); color:var(--text-primary); border:1px solid var(--border-color); border-radius:5px; padding:0.75rem; font-size:1rem; margin-bottom:1rem; }
    .post-creator-actions { display:flex; justify-content:flex-end; gap:1rem; align-items:center; }
    #media-upload-label { cursor:pointer; padding:0.5rem; border-radius:50%; transition:background 0.2s; }
    #media-upload-label:hover { background:var(--accent-color); }
    #media-upload { display:none; }
    #post-submit-btn { background:var(--primary-action); border:none; padding:0.75rem 1.5rem; border-radius:5px; font-weight:500; color:#fff; cursor:pointer; transition:0.2s; }
    #post-submit-btn:hover { background:var(--primary-action-hover); }
    .progress-bar-container { width:100%; height:8px; background:var(--accent-color); border-radius:4px; margin-top:1rem; display:none; }
    #upload-progress { width:0%; height:100%; background:var(--primary-action); border-radius:4px; transition:width 0.3s; }

    /* Post cards */
    .post-card { background:var(--card-background); padding:1.5rem; border-radius:8px; margin-bottom:1.5rem; border-left:4px solid var(--accent-color); transition:0.2s; }
    .post-card.clickable:hover { transform:translateY(-3px); box-shadow:0 4px 20px rgba(0,0,0,0.2); cursor:pointer; }
    .post-header { display:flex; font-size:0.9rem; color:var(--text-secondary); margin-bottom:1rem; }
    .post-author { font-weight:600; color:var(--primary-action); }
    .post-date { margin-left:auto; }
    .post-content { font-size:1.1rem; line-height:1.6; white-space:pre-wrap; word-wrap:break-word; }
    .post-footer { display:flex; gap:1.5rem; margin-top:1.5rem; color:var(--text-secondary); }
    .post-footer-item { display:flex; align-items:center; gap:0.5rem; }
    .post-footer-item.upvote-btn { cursor:pointer; }
    .post-footer-item.upvote-btn:hover { color:var(--primary-action); }

    /* Loader */
    .loader { border:4px solid var(--accent-color); border-top:4px solid var(--primary-action); border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite; margin:3rem auto; }
    @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }

    /* Post detail */
    #post-detail-view { display:none; }
    .detail-container { max-width:900px; margin:2rem auto; padding:0 1rem; }
    #back-to-forum-btn { background:none; border:1px solid var(--border-color); color:var(--text-secondary); padding:0.5rem 1rem; border-radius:5px; cursor:pointer; margin-bottom:1.5rem; }
    #back-to-forum-btn:hover { background:var(--accent-color); }
    .thread-card { background:var(--accent-color); border:1px solid var(--border-color); padding:1.5rem; border-radius:5px; margin-top:1.5rem; }
    .thread-form { margin-top:2rem; }
  </style>
</head>
<body>
  <nav class="navbar">
    <h1>Student Forum</h1>
    <button id="logout-btn">Logout</button>
  </nav>

  <!-- Feed View -->
  <div id="feed-view">
    <main class="main-layout">
      <aside class="sidebar">
        <h3>Sort Posts</h3>
        <div class="sort-options">
          <button id="sort-newest" class="active">Newest</button>
          <button id="sort-popular">Most Popular</button>
        </div>
      </aside>
      <section class="main-content">
        <div class="post-creator">
          <textarea id="post-textarea" placeholder="Ask a question anonymously..."></textarea>
          <div class="progress-bar-container" id="progress-container">
            <div id="upload-progress"></div>
          </div>
          <div class="post-creator-actions">
            <label for="media-upload" id="media-upload-label" title="Add Photo or Video">
              ðŸ“Ž
            </label>
            <input type="file" id="media-upload" accept="image/*,video/*">
            <button id="post-submit-btn">Post</button>
          </div>
        </div>
        <div id="posts-container">
          <div class="loader"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Post Detail -->
  <div id="post-detail-view">
    <div class="detail-container">
      <button id="back-to-forum-btn">&larr; Back to Forum</button>
      <div id="single-post-container"></div>
      <div id="threads-container"></div>
    </div>
  </div>

  <!-- Firebase + Scripts -->
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-storage.js"></script>
  <script src="firebase-config.js" type="module"></script>
  <script src="forum.js" type="module"></script>
</body>
</html>
