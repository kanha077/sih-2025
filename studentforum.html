<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Forum | Ananda Mental Health</title>
    
    <script>
        (function() {
            const theme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (theme === 'dark' || (!theme && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        :root {
            /* Ananda Brand Colors - Matching index.html */
            --primary: 220 70% 50%; 
            --primary-foreground: 0 0% 98%; 
            --secondary: 280 60% 50%; 
            --secondary-foreground: 0 0% 98%; 
            --accent: 340 75% 55%; 
            --accent-foreground: 0 0% 98%; 
            --background: 0 0% 100%; 
            --foreground: 224 71.4% 4.1%; 
            --muted: 220 14.3% 95.9%; 
            --muted-foreground: 220 8.9% 46.1%; 
            --border: 220 13% 91%; 
            --ring: 220 70% 50%; 
            --card: 0 0% 100%; 
            --card-foreground: 224 71.4% 4.1%; 
            --input: 220 14.3% 95.9%;
            --destructive: 0 84% 60%;
            --destructive-foreground: 0 0% 98%;
            --popover: 0 0% 100%;
            --popover-foreground: 224 71.4% 4.1%;
            
            /* Enhanced gradients and effects */
            --gradient-primary: linear-gradient(135deg, hsl(var(--primary)), hsl(280 65% 60%)); 
            --gradient-secondary: linear-gradient(135deg, hsl(var(--secondary)), hsl(260 70% 55%)); 
            --gradient-accent: linear-gradient(135deg, hsl(var(--accent)), hsl(320 80% 60%)); 
            --gradient-hero: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--secondary)), hsl(var(--accent))); 
            --gradient-card: linear-gradient(145deg, hsl(var(--card)), hsl(var(--muted) / 0.3)); 
            --gradient-glass: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            --gradient-forum: linear-gradient(135deg, hsl(var(--primary) / 0.1), hsl(var(--secondary) / 0.1), hsl(var(--accent) / 0.1));
            
            /* Shadows */
            --shadow-elegant: 0 10px 30px -10px hsl(var(--primary) / 0.3); 
            --shadow-primary: 0 0 40px hsl(var(--primary) / 0.4); 
            --shadow-secondary: 0 0 40px hsl(var(--secondary) / 0.4); 
            --shadow-accent: 0 0 40px hsl(var(--accent) / 0.4);
            --shadow-card: 0 8px 32px hsl(220 13% 0% / 0.1);
            --shadow-glass: 0 8px 32px rgba(31, 38, 135, 0.37);
            
            /* Transitions */
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            --transition-spring: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            
            /* Radius */
            --radius: 0.75rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --radius-full: 9999px;
        }

        .dark {
            --primary: 220 70% 55%; 
            --secondary: 280 60% 55%; 
            --accent: 340 75% 60%; 
            --background: 224 71.4% 4.1%; 
            --foreground: 0 0% 98%; 
            --muted: 220 13% 18%; 
            --muted-foreground: 220 8.9% 64.9%; 
            --border: 220 13% 24%; 
            --card: 224 71.4% 6%; 
            --card-foreground: 0 0% 98%; 
            --input: 220 13% 18%;
            --popover: 224 71.4% 6%;
            --popover-foreground: 0 0% 98%;
            --shadow-elegant: 0 10px 30px -10px hsl(var(--primary) / 0.2);
            --shadow-card: 0 8px 32px hsl(220 13% 0% / 0.3);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: hsl(var(--background)); color: hsl(var(--foreground)); line-height: 1.6; transition: var(--transition-smooth); min-height: 100vh; position: relative; overflow-x: hidden; }
        body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 20% 80%, hsl(var(--primary) / 0.08) 0%, transparent 50%), radial-gradient(circle at 80% 20%, hsl(var(--secondary) / 0.08) 0%, transparent 50%), radial-gradient(circle at 40% 40%, hsl(var(--accent) / 0.06) 0%, transparent 50%), linear-gradient(135deg, hsl(var(--background)), hsl(var(--muted) / 0.2)); pointer-events: none; z-index: -1; animation: backgroundFlow 30s ease-in-out infinite; }
        @keyframes backgroundFlow { 0%, 100% { transform: translateX(0) translateY(0) scale(1) rotate(0deg); filter: hue-rotate(0deg); } 25% { transform: translateX(-20px) translateY(-30px) scale(1.05) rotate(1deg); filter: hue-rotate(90deg); } 50% { transform: translateX(30px) translateY(20px) scale(0.95) rotate(-1deg); filter: hue-rotate(180deg); } 75% { transform: translateX(-10px) translateY(25px) scale(1.02) rotate(0.5deg); filter: hue-rotate(270deg); } }
        .navbar { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px) saturate(180%); border-bottom: 1px solid hsl(var(--border) / 0.5); padding: 1.25rem 2rem; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: var(--shadow-glass); transition: var(--transition-smooth); }
        .dark .navbar { background: rgba(0, 0, 0, 0.2); border-bottom: 1px solid hsl(var(--border) / 0.3); }
        .navbar::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: var(--gradient-primary); opacity: 0.6; }
        .navbar h1 { margin: 0; font-size: 1.875rem; font-weight: 800; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: -0.02em; text-shadow: 0 0 30px hsl(var(--primary) / 0.5); }
        .nav-actions { display: flex; align-items: center; gap: 1rem; }
        .theme-toggle, .notification-btn { background: hsl(var(--card) / 0.8); backdrop-filter: blur(10px); border: 2px solid hsl(var(--border)); color: hsl(var(--muted-foreground)); padding: 0.75rem; border-radius: var(--radius-full); cursor: pointer; transition: var(--transition-spring); display: flex; align-items: center; justify-content: center; width: 48px; height: 48px; position: relative; overflow: hidden; }
        .theme-toggle::before, .notification-btn::before { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; background: var(--gradient-primary); border-radius: 50%; transform: translate(-50%, -50%); transition: var(--transition-spring); z-index: -1; }
        .theme-toggle:hover, .notification-btn:hover { border-color: hsl(var(--primary)); color: hsl(var(--primary-foreground)); transform: scale(1.1) rotate(5deg); box-shadow: var(--shadow-primary); }
        .theme-toggle:hover::before, .notification-btn:hover::before { width: 100%; height: 100%; }
        .logout-btn { background: var(--gradient-secondary); color: hsl(var(--secondary-foreground)); border: none; padding: 0.875rem 1.75rem; border-radius: var(--radius-full); cursor: pointer; font-weight: 600; font-size: 0.875rem; transition: var(--transition-bounce); box-shadow: var(--shadow-secondary); position: relative; overflow: hidden; }
        .logout-btn::before { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; background: rgba(255, 255, 255, 0.2); border-radius: 50%; transform: translate(-50%, -50%); transition: var(--transition-spring); }
        .logout-btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 20px 40px hsl(var(--secondary) / 0.4); }
        .logout-btn:active::before { width: 300px; height: 300px; }
        .mobile-menu-toggle { display: none; background: none; border: none; color: hsl(var(--foreground)); font-size: 1.5rem; cursor: pointer; padding: 0.5rem; }
        .main-container { max-width: 1400px; margin: 2.5rem auto; padding: 0 1.5rem; display: grid; grid-template-columns: 300px 1fr 300px; gap: 2.5rem; animation: slideInUp 0.8s ease-out; }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        .sidebar, .right-sidebar { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px) saturate(180%); padding: 2rem; border-radius: var(--radius-xl); height: fit-content; border: 1px solid hsl(var(--border) / 0.5); box-shadow: var(--shadow-glass); position: sticky; top: 140px; transition: var(--transition-smooth); }
        .dark .sidebar, .dark .right-sidebar { background: rgba(0, 0, 0, 0.2); border: 1px solid hsl(var(--border) / 0.3); }
        .sidebar:hover, .right-sidebar:hover { transform: translateY(-5px); box-shadow: var(--shadow-elegant); }
        .sidebar h3, .right-sidebar h3 { margin: 0 0 1.5rem 0; font-size: 1.25rem; font-weight: 700; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; border-bottom: 2px solid hsl(var(--primary) / 0.2); padding-bottom: 0.75rem; position: relative; }
        .sidebar h3::after, .right-sidebar h3::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 50%; height: 2px; background: var(--gradient-primary); border-radius: var(--radius-full); }
        .filter-group { margin-bottom: 2rem; }
        .filter-option { display: block; width: 100%; background: hsl(var(--card) / 0.6); backdrop-filter: blur(10px); border: 1px solid hsl(var(--border) / 0.5); color: hsl(var(--muted-foreground)); text-align: left; padding: 1rem 1.25rem; border-radius: var(--radius); cursor: pointer; font-size: 0.95rem; font-weight: 500; margin-bottom: 0.75rem; transition: var(--transition-spring); position: relative; overflow: hidden; }
        .filter-option::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: var(--gradient-primary); transition: var(--transition-spring); z-index: -1; }
        .filter-option.active, .filter-option:hover { color: hsl(var(--primary-foreground)); transform: translateX(8px) scale(1.02); border-color: hsl(var(--primary) / 0.5); box-shadow: var(--shadow-primary); }
        .filter-option.active::before, .filter-option:hover::before { left: 0; }
        .post-creator { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px) saturate(180%); padding: 2.5rem; border-radius: var(--radius-xl); margin-bottom: 2.5rem; border: 1px solid hsl(var(--border) / 0.5); box-shadow: var(--shadow-glass); transition: var(--transition-smooth); position: relative; overflow: hidden; }
        .dark .post-creator { background: rgba(0, 0, 0, 0.2); border: 1px solid hsl(var(--border) / 0.3); }
        .post-creator::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: conic-gradient(from 0deg, transparent, hsl(var(--primary) / 0.1), transparent); animation: rotateGradient 6s linear infinite; z-index: 0; }
        @keyframes rotateGradient { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .post-creator > * { position: relative; z-index: 1; }
        .post-creator:hover { transform: translateY(-5px); box-shadow: var(--shadow-primary); }
        .post-textarea { width: 100%; min-height: 140px; border: 2px solid hsl(var(--border) / 0.5); border-radius: var(--radius-lg); padding: 1.5rem; font-family: 'Inter', sans-serif; font-size: 1rem; margin-bottom: 1.5rem; resize: vertical; background: hsl(var(--card) / 0.8); backdrop-filter: blur(10px); color: hsl(var(--foreground)); transition: var(--transition-smooth); line-height: 1.6; }
        .post-textarea:focus { outline: none; border-color: hsl(var(--primary)); box-shadow: 0 0 0 4px hsl(var(--primary) / 0.1); background: hsl(var(--card)); transform: scale(1.02); }
        .post-textarea::placeholder { color: hsl(var(--muted-foreground)); font-weight: 400; }
        .post-actions { display: flex; justify-content: space-between; align-items: center; gap: 1rem; }
        .post-options { display: flex; gap: 1rem; }
        .option-btn { background: hsl(var(--muted) / 0.8); backdrop-filter: blur(10px); border: 2px solid hsl(var(--border) / 0.5); color: hsl(var(--muted-foreground)); padding: 0.875rem; border-radius: var(--radius); cursor: pointer; transition: var(--transition-spring); display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }
        .option-btn.active { border-color: hsl(var(--primary)); color: hsl(var(--primary)); }
        .option-btn::before { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; background: var(--gradient-accent); border-radius: 50%; transform: translate(-50%, -50%); transition: var(--transition-spring); z-index: -1; }
        .option-btn:hover { border-color: hsl(var(--accent)); color: hsl(var(--accent-foreground)); transform: translateY(-3px) scale(1.1); box-shadow: var(--shadow-accent); }
        .option-btn:hover::before { width: 100%; height: 100%; }
        .submit-btn { background: var(--gradient-primary); color: hsl(var(--primary-foreground)); border: none; padding: 1rem 2.5rem; border-radius: var(--radius-full); cursor: pointer; font-weight: 600; font-size: 1rem; transition: var(--transition-bounce); box-shadow: var(--shadow-primary); position: relative; overflow: hidden; letter-spacing: 0.02em; }
        .submit-btn::before { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; background: rgba(255, 255, 255, 0.3); border-radius: 50%; transform: translate(-50%, -50%); transition: var(--transition-spring); }
        .submit-btn:hover { transform: translateY(-4px) scale(1.05); box-shadow: 0 25px 50px hsl(var(--primary) / 0.4); }
        .submit-btn:active::before { width: 300px; height: 300px; }
        .post-card { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px) saturate(180%); padding: 2.5rem; border-radius: var(--radius-xl); margin-bottom: 2rem; border: 1px solid hsl(var(--border) / 0.5); box-shadow: var(--shadow-glass); transition: var(--transition-smooth); position: relative; overflow: hidden; }
        .post-card.clickable { cursor: pointer; }
        .dark .post-card { background: rgba(0, 0, 0, 0.2); border: 1px solid hsl(var(--border) / 0.3); }
        .post-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--gradient-primary); transform: scaleX(0); transform-origin: left; transition: var(--transition-smooth); }
        .post-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: var(--shadow-primary); border-color: hsl(var(--primary) / 0.5); }
        .post-card:hover::before { transform: scaleX(1); }
        .post-card.user-post { border: 2px solid hsl(var(--primary) / 0.5); background: linear-gradient(145deg, hsl(var(--primary) / 0.1), rgba(255, 255, 255, 0.15)); }
        .dark .post-card.user-post { background: linear-gradient(145deg, hsl(var(--primary) / 0.1), rgba(0, 0, 0, 0.25)); }
        .post-card.user-post::after { content: '✨ Your Post'; position: absolute; top: 1.5rem; right: 1.5rem; background: var(--gradient-primary); color: white; padding: 0.5rem 1.25rem; border-radius: var(--radius-full); font-size: 0.75rem; font-weight: 600; box-shadow: var(--shadow-primary); animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.8; transform: scale(1.05); } }
        .post-header { display: flex; align-items: center; gap: 1.25rem; margin-bottom: 1.75rem; }
        .user-avatar { width: 52px; height: 52px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.25rem; box-shadow: var(--shadow-primary); border: 3px solid hsl(var(--card)); }
        .post-meta { flex: 1; }
        .post-author { font-weight: 600; color: hsl(var(--card-foreground)); font-size: 1.1rem; margin-bottom: 0.25rem; }
        .post-time { font-size: 0.875rem; color: hsl(var(--muted-foreground)); opacity: 0.8; }
        .post-content { font-size: 1.125rem; line-height: 1.75; white-space: pre-wrap; word-wrap: break-word; color: hsl(var(--card-foreground)); margin-bottom: 2rem; font-weight: 400; }
        .post-footer { display: flex; align-items: center; gap: 2rem; color: hsl(var(--muted-foreground)); padding-top: 1.5rem; border-top: 1px solid hsl(var(--border) / 0.5); }
        .action-btn { display: flex; align-items: center; gap: 0.75rem; background: hsl(var(--muted) / 0.5); backdrop-filter: blur(10px); border: 1px solid hsl(var(--border) / 0.5); color: hsl(var(--muted-foreground)); cursor: pointer; padding: 0.75rem 1.5rem; border-radius: var(--radius-full); transition: var(--transition-spring); font-size: 0.9rem; font-weight: 500; position: relative; overflow: hidden; }
        .action-btn::before { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; background: var(--gradient-secondary); border-radius: 50%; transform: translate(-50%, -50%); transition: var(--transition-spring); z-index: -1; }
        .action-btn:hover { color: hsl(var(--secondary-foreground)); transform: scale(1.05); border-color: hsl(var(--secondary)); box-shadow: var(--shadow-secondary); }
        .action-btn:hover::before { width: 100%; height: 100%; }
        .action-btn.liked { color: hsl(var(--primary)); background: hsl(var(--primary) / 0.1); border-color: hsl(var(--primary) / 0.5); }
        .trending-topics { margin-bottom: 2rem; }
        .trending-topic { padding: 1.25rem; margin-bottom: 1rem; background: hsl(var(--muted) / 0.4); backdrop-filter: blur(10px); border-radius: var(--radius); border-left: 4px solid hsl(var(--primary)); cursor: pointer; transition: var(--transition-spring); position: relative; overflow: hidden; }
        .trending-topic::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--gradient-primary); transform: scaleY(0); transform-origin: bottom; transition: var(--transition-spring); }
        .trending-topic.active, .trending-topic:hover { transform: translateX(8px) scale(1.02); background: hsl(var(--primary) / 0.1); border-left-color: hsl(var(--secondary)); box-shadow: var(--shadow-elegant); }
        .trending-topic.active { border-left-color: hsl(var(--primary)); }
        .trending-topic.active::before, .trending-topic:hover::before { transform: scaleY(1); }
        .topic-name { font-weight: 600; color: hsl(var(--card-foreground)); margin-bottom: 0.5rem; font-size: 1rem; }
        .topic-count { font-size: 0.8rem; color: hsl(var(--muted-foreground)); opacity: 0.8; }
        .floating-action { position: fixed; bottom: 2.5rem; right: 2.5rem; width: 64px; height: 64px; background: var(--gradient-primary); border: none; border-radius: 50%; color: white; font-size: 1.5rem; cursor: pointer; box-shadow: var(--shadow-primary); transition: var(--transition-bounce); z-index: 100; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .floating-action:hover { transform: scale(1.15) translateY(-5px); box-shadow: 0 25px 50px hsl(var(--primary) / 0.5); }
        .loader { border: 4px solid hsl(var(--muted) / 0.3); border-top: 4px solid hsl(var(--primary)); border-radius: 50%; width: 60px; height: 60px; animation: spin 1s linear infinite; margin: 4rem auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .progress-bar-container { width: 100%; height: 10px; background: hsl(var(--muted) / 0.5); border-radius: var(--radius-full); margin: 1rem 0; display: none; overflow: hidden; box-shadow: inset 0 2px 4px hsl(var(--muted) / 0.3); }
        #upload-progress { width: 0%; height: 100%; background: var(--gradient-primary); border-radius: var(--radius-full); transition: width 0.3s ease; box-shadow: 0 0 10px hsl(var(--primary) / 0.5); }
        .detail-container { max-width: 1000px; margin: 2.5rem auto; padding: 0 1.5rem; animation: slideInUp 0.6s ease-out; }
        #back-to-forum-btn { background: hsl(var(--muted) / 0.8); backdrop-filter: blur(10px); border: 1px solid hsl(var(--border)); color: hsl(var(--foreground)); padding: 1rem 2rem; border-radius: var(--radius-full); cursor: pointer; margin-bottom: 2rem; transition: var(--transition-spring); font-weight: 500; display: flex; align-items: center; gap: 0.75rem; }
        #back-to-forum-btn:hover { background: hsl(var(--primary) / 0.1); color: hsl(var(--primary)); transform: translateX(-8px) scale(1.02); border-color: hsl(var(--primary)); box-shadow: var(--shadow-primary); }
        @media (max-width: 1024px) { .main-container { grid-template-columns: 280px 1fr; gap: 2rem; } .right-sidebar { display: none; } }
        @media (max-width: 768px) { .navbar { padding: 1rem; flex-wrap: wrap; gap: 1rem; } .navbar h1 { font-size: 1.5rem; } .nav-actions { gap: 0.75rem; } .logout-btn { padding: 0.75rem 1.25rem; font-size: 0.8rem; } .mobile-menu-toggle { display: block; } .main-container { grid-template-columns: 1fr; gap: 1.5rem; margin: 1.5rem auto; padding: 0 1rem; } .sidebar { position: static; order: 2; padding: 1.5rem; border-radius: var(--radius-lg); } .post-creator, .post-card { padding: 2rem; border-radius: var(--radius-lg); } .post-textarea { min-height: 120px; padding: 1.25rem; } .post-actions { flex-direction: column; align-items: stretch; gap: 1.5rem; } .submit-btn { width: 100%; padding: 1.25rem; } .post-footer { flex-direction: column; align-items: flex-start; gap: 1rem; } .detail-container { padding: 0 1rem; } .floating-action { bottom: 1.5rem; right: 1.5rem; width: 56px; height: 56px; font-size: 1.25rem; } }
        @media (max-width: 480px) { .navbar { padding: 1rem; } .navbar h1 { font-size: 1.25rem; } .post-creator, .post-card { padding: 1.5rem; border-radius: var(--radius); } .sidebar { padding: 1.5rem; } .post-content { font-size: 1rem; } .post-options { flex-wrap: wrap; gap: 0.75rem; } .option-btn { flex: 1; min-width: 44px; } }
        button:focus-visible, textarea:focus-visible { outline: 3px solid hsl(var(--primary) / 0.5); outline-offset: 2px; }
        html { scroll-behavior: smooth; }
        ::selection { background: hsl(var(--primary) / 0.3); color: hsl(var(--foreground)); }
        #post-detail-view { display: none; }
        .hidden { display: none !important; }
        .loading { opacity: 0.6; pointer-events: none; filter: blur(1px); }
        @media (max-width: 768px) { .sidebar.mobile-open { position: fixed; top: 100px; left: 0; right: 0; z-index: 999; order: 0; margin: 1rem; animation: slideInDown 0.3s ease-out; } @keyframes slideInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } } }
        .post-media, .post-media-container { margin: 1.5rem 0; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-elegant); }
        .post-media img, .post-media video, .post-media-container img, .post-media-container video { width: 100%; height: auto; max-height: 500px; object-fit: cover; }
        .thread-card { background: hsl(var(--muted) / 0.3); backdrop-filter: blur(10px); border: 1px solid hsl(var(--border) / 0.5); padding: 2rem; border-radius: var(--radius-lg); margin-top: 2rem; }
        .thread-form { margin-top: 2rem; }

        /* --- NEW: POLL STYLES --- */
        #poll-creator-container { margin-top: 1.5rem; border-top: 1px solid hsl(var(--border)); padding-top: 1.5rem; }
        .poll-option-input { width: 100%; background: hsl(var(--input)); border: 1px solid hsl(var(--border)); border-radius: var(--radius); padding: 0.75rem 1rem; font-size: 0.95rem; margin-bottom: 0.75rem; color: hsl(var(--foreground)); }
        #add-poll-option-btn { background: hsl(var(--muted)); color: hsl(var(--muted-foreground)); border: 1px dashed hsl(var(--border)); width: 100%; padding: 0.75rem; border-radius: var(--radius); cursor: pointer; transition: var(--transition-smooth); }
        #add-poll-option-btn:hover { background: hsl(var(--primary) / 0.1); color: hsl(var(--primary)); }
        .poll-container { margin: 1.5rem 0; display: flex; flex-direction: column; gap: 0.75rem; }
        .poll-option { background: hsl(var(--muted) / 0.5); border: 2px solid hsl(var(--border)); padding: 1rem 1.5rem; border-radius: var(--radius-full); cursor: pointer; transition: var(--transition-spring); position: relative; overflow: hidden; }
        .poll-option:hover { border-color: hsl(var(--primary)); }
        .poll-option.voted { border-color: hsl(var(--accent)); font-weight: 600; color: hsl(var(--accent)); }
        .poll-option-fill { position: absolute; top: 0; left: 0; height: 100%; background: hsl(var(--primary) / 0.15); border-radius: var(--radius-full); z-index: 0; transition: width 0.5s ease; }
        .poll-option-text, .poll-option-percent { position: relative; z-index: 1; }
        .poll-option-info { display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>
    <nav class="navbar">
        <h1>Student Forum</h1>
        <div class="nav-actions">
            <button class="theme-toggle" id="theme-toggle" title="Toggle theme"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg></button>
            <button class="notification-btn" title="Notifications"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg></button>
            <button class="mobile-menu-toggle">☰</button>
            <button id="logout-btn" class="logout-btn">Logout</button>
        </div>
    </nav>
    
    <div id="feed-view">
        <main class="main-container">
            <aside class="sidebar">
                <h3>📂 Categories</h3>
                <div class="filter-group">
                    <button class="filter-option active" data-filter="all">🌟 All Posts</button>
                    <button class="filter-option" data-filter="my-posts">👤 My Posts</button>
                    <a href="academic.chat.html" class="filter-option" style="text-decoration: none;">📚 Academic Help</a>                    
                    <a href="social.html" class="filter-option" style="text-decoration: none;">👥 Social</a>
                    <a href="mental.health.html" class="filter-option" style="text-decoration: none;">🧘 Mental Health </a>
                    <a href= "career1.html" class="filter-option" style="text-decoration: none;">💼 Career Advice</a>
                </div>
                <h3>📊 Sort By</h3>
                <div class="filter-group">
                    <button id="sort-newest" class="filter-option active">⏰ Newest</button>
                    <button id="sort-popular" class="filter-option">🔥 Most Popular</button>
                    <button class="filter-option">💬 Most Discussed</button>
                </div>
            </aside>
            
            <section class="main-content">
                <div class="post-creator">
                    <textarea id="post-textarea" class="post-textarea" placeholder="Share your thoughts anonymously... What's on your mind? 💭"></textarea>
                    
                    <!-- NEW: POLL CREATOR UI -->
                    <div id="poll-creator-container" style="display: none;">
                        <div id="poll-options-inputs">
                            <input type="text" class="poll-option-input" placeholder="Poll Option 1" maxlength="80">
                            <input type="text" class="poll-option-input" placeholder="Poll Option 2" maxlength="80">
                        </div>
                        <button id="add-poll-option-btn">+ Add Option</button>
                    </div>

                    <div class="progress-bar-container" id="progress-container">
                        <div id="upload-progress"></div>
                    </div>
                    <div class="post-actions">
                        <div class="post-options">
                            <label for="media-upload" class="option-btn" title="Add Photo or Video">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
                            </label>
                            <input type="file" id="media-upload" accept="image/*,video/*" style="display: none;">
                            <button class="option-btn" id="create-poll-btn" title="Add Poll">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/></svg>
                            </button>
                            <button class="option-btn" title="Anonymous Mode">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" y1="2" x2="22" y2="22"/></svg>
                            </button>
                        </div>
                        <button id="post-submit-btn" class="submit-btn">✨ Post</button>
                    </div>
                </div>
                
                <div id="posts-container">
                    <div class="loader"></div>
                </div>
            </section>
            
            <aside class="right-sidebar">
                <h3>🏷️ Popular Tags</h3>
                <div class="trending-topics">
                    <div class="trending-topic" data-tag="studytips"><div class="topic-name">#StudyTips</div><div class="topic-count">Filter by this tag</div></div>
                    <div class="trending-topic" data-tag="mentalhealth"><div class="topic-name">#MentalHealth</div><div class="topic-count">Filter by this tag</div></div>
                    <div class="trending-topic" data-tag="careeradvice"><div class="topic-name">#CareerAdvice</div><div class="topic-count">Filter by this tag</div></div>
                    <div class="trending-topic" data-tag="unhappy"><div class="topic-name">#Unhappy</div><div class="topic-count">Filter by this tag</div></div>
                    <div class="trending-topic" data-tag="projecthelp"><div class="topic-name">#ProjectHelp</div><div class="topic-count">Filter by this tag</div></div>
                    <div class="trending-topic" data-tag="studentlife"><div class="topic-name">#StudentLife</div><div class="topic-count">Filter by this tag</div></div>
                </div>
                <h3>📢 Quick Actions</h3>
                <div class="filter-group">
                    <button class="filter-option">💡 Ask Question</button>
                    <button class="filter-option">📝 Share Experience</button>
                    <button class="filter-option">🤝 Find Study Buddy</button>
                    <button class="filter-option">📅 Study Schedule</button>
                </div>
            </aside>
        </main>
    </div>

    <div id="post-detail-view">
        <div class="detail-container">
            <button id="back-to-forum-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg> Back to Forum</button>
            <div id="single-post-container"></div>
            <div id="threads-container"></div>
        </div>
    </div>

    <button class="floating-action" title="Quick Post"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg></button>

    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-storage.js"></script> 
    
    <script src="firebase-config.js" type="module"></script>
    <script src="forum.js" type="module"></script>
    
    <script>
        // --- THEME TOGGLE LOGIC ---
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        const themeIcon = themeToggle.querySelector('svg');
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            html.classList.add('dark');
        }
        updateThemeIcon(savedTheme);
        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            const newTheme = html.classList.contains('dark') ? 'dark' : 'light';
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });
        function updateThemeIcon(theme) {
            if (theme === 'dark') {
                themeIcon.innerHTML = `<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>`;
            } else {
                themeIcon.innerHTML = `<circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>`;
            }
        }

        // --- CONSOLIDATED AND FIXED INTERACTIVITY SCRIPT ---
        document.addEventListener('DOMContentLoaded', () => {
            // --- UI Elements ---
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            const sidebar = document.querySelector('.sidebar');
            const floatingAction = document.querySelector('.floating-action');
            const postTextarea = document.getElementById('post-textarea');
            const allFilterOptions = document.querySelectorAll('.filter-option'); 
            const quickActionButtons = document.querySelectorAll('.right-sidebar .filter-option');
            const trendingTopics = document.querySelectorAll('.trending-topic');
            
            // --- NEW: Poll UI Elements ---
            const createPollBtn = document.getElementById('create-poll-btn');
            const pollCreatorContainer = document.getElementById('poll-creator-container');
            const pollOptionsInputs = document.getElementById('poll-options-inputs');
            const addPollOptionBtn = document.getElementById('add-poll-option-btn');
            let isPollActive = false;

            // --- Mobile Menu ---
            mobileMenuToggle.addEventListener('click', () => sidebar.classList.toggle('mobile-open'));
            document.addEventListener('click', (e) => {
                if (!sidebar.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
                    sidebar.classList.remove('mobile-open');
                }
            });

            // --- Floating Action Button ---
            floatingAction.addEventListener('click', () => {
                postTextarea.focus();
                postTextarea.scrollIntoView({ behavior: 'smooth', block: 'center' });
            });

            // --- General Filter Button Active State ---
            allFilterOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    if (e.currentTarget.tagName.toLowerCase() === 'a') return;
                    const parent = option.closest('.filter-group');
                    if (parent) {
                        parent.querySelectorAll('.filter-option').forEach(opt => opt.classList.remove('active'));
                        option.classList.add('active');
                    }
                });
            });

            // --- Right Sidebar Quick Actions (updates textarea) ---
            quickActionButtons.forEach(action => {
                action.addEventListener('click', () => {
                    const actionText = action.textContent.trim();
                    let placeholder = '';
                    switch(actionText) {
                        case '💡 Ask Question': placeholder = 'I have a question about...'; break;
                        case '📝 Share Experience': placeholder = 'I want to share my experience with...'; break;
                        case '🤝 Find Study Buddy': placeholder = 'Looking for a study buddy for...'; break;
                        case '📅 Study Schedule': placeholder = 'Here\'s my study schedule...'; break;
                    }
                    if (placeholder) {
                        postTextarea.value = placeholder;
                        postTextarea.focus();
                        postTextarea.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                });
            });
            
            // --- Trending Topics Click ---
            trendingTopics.forEach(topic => {
                topic.addEventListener('click', () => {
                    const topicName = topic.querySelector('.topic-name').textContent;
                    if (!postTextarea.value.includes(topicName)) {
                        postTextarea.value += `${topicName} `;
                    }
                    postTextarea.focus();
                });
            });
            
            // --- NEW: Poll Creator UI Logic ---
            createPollBtn.addEventListener('click', () => {
                isPollActive = !isPollActive;
                pollCreatorContainer.style.display = isPollActive ? 'block' : 'none';
                createPollBtn.classList.toggle('active', isPollActive);
            });

            addPollOptionBtn.addEventListener('click', () => {
                const optionInputs = pollOptionsInputs.querySelectorAll('.poll-option-input');
                if (optionInputs.length < 5) { // Limit to 5 options
                    const newOption = document.createElement('input');
                    newOption.type = 'text';
                    newOption.className = 'poll-option-input';
                    newOption.placeholder = `Poll Option ${optionInputs.length + 1}`;
                    newOption.maxLength = 80;
                    pollOptionsInputs.appendChild(newOption);
                } else {
                    alert("You can add a maximum of 5 poll options.");
                }
            });

            // --- Auto-resize Textarea ---
            postTextarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 400) + 'px';
            });
            
            // --- Keyboard Shortcuts ---
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter' && document.activeElement === postTextarea) {
                    document.getElementById('post-submit-btn').click();
                }
                if (e.key === 'Escape') {
                    sidebar.classList.remove('mobile-open');
                }
            });
        });
    </script>
</body>
</html>

